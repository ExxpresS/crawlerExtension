<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workflow Recorder</title>
    <link rel="stylesheet" href="popup.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üé¨ Workflow Recorder</h1>
        </header>

        <main>
            <!-- Mode Idle -->
            <div id="idle-mode" class="mode">
                <div class="status">
                    <p>Aucun enregistrement en cours</p>
                </div>
                <button id="start-btn" class="btn btn-primary">
                    üî¥ D√©marrer l'enregistrement
                </button>

                <section class="recent-workflows">
                    <h3>Derniers workflows</h3>
                    <div id="recent-list">
                        <p class="empty-state">Aucun workflow enregistr√©</p>
                    </div>
                </section>

                <section class="stats">
                    <p>Total workflows : <span id="total-count">0</span></p>
                </section>
            </div>

            <!-- Mode Recording -->
            <div id="recording-mode" class="mode hidden">
                <div class="status recording">
                    <p>‚è∫ Enregistrement en cours...</p>
                    <div class="timer">
                        <span id="recording-timer">00:00</span>
                    </div>
                </div>

                <div class="counters">
                    <div class="counter">
                        <span class="label">Actions :</span>
                        <span id="action-count">0</span>
                    </div>
                    <div class="counter">
                        <span class="label">√âtats :</span>
                        <span id="state-count">0</span>
                    </div>
                </div>

                <div class="recording-controls">
                    <button id="stop-btn" class="btn btn-primary">
                        ‚èπ Arr√™ter l'enregistrement
                    </button>
                    <button id="cancel-btn" class="btn btn-secondary">
                        ‚ùå Annuler
                    </button>
                </div>
            </div>

            <!-- Mode Review -->
            <div id="review-mode" class="mode hidden">
                <div class="status">
                    <h2>‚úÖ Workflow captur√© avec succ√®s</h2>
                </div>

                <div class="summary">
                    <div class="summary-stats">
                        <div class="stat">
                            <span class="stat-number" id="summary-actions">0</span>
                            <span class="stat-label">Actions</span>
                        </div>
                        <div class="stat">
                            <span class="stat-number" id="summary-states">0</span>
                            <span class="stat-label">√âtats</span>
                        </div>
                        <div class="stat">
                            <span class="stat-number" id="summary-duration">0</span>
                            <span class="stat-label">Minutes</span>
                        </div>
                    </div>
                </div>

                <form id="workflow-form">
                    <div class="form-group">
                        <label for="workflow-title">Titre du workflow *</label>
                        <input type="text" id="workflow-title" required placeholder="Ex: Cr√©er une facture client">
                        <div class="help-text">D√©crivez le but principal de ce workflow</div>
                    </div>

                    <div class="form-group">
                        <label for="workflow-description">Description</label>
                        <textarea id="workflow-description" rows="3" placeholder="Description d√©taill√©e du processus, contexte, pr√©requis..."></textarea>
                        <div class="help-text">Ajoutez des d√©tails pour aider √† comprendre ce workflow</div>
                    </div>

                    <div class="form-group">
                        <label for="workflow-tags">Tags</label>
                        <input type="text" id="workflow-tags" placeholder="facturation, client, vente">
                        <div class="help-text">Tags s√©par√©s par des virgules pour organiser vos workflows</div>
                        <div id="suggested-tags" class="suggested-tags"></div>
                    </div>
                </form>

                <div class="review-preview">
                    <h4>üìã Aper√ßu du parcours</h4>
                    <div id="workflow-preview" class="workflow-steps">
                        <!-- √âtapes g√©n√©r√©es dynamiquement -->
                    </div>
                </div>

                <div class="review-controls">
                    <button id="save-btn" class="btn btn-primary">
                        üíæ Sauvegarder le workflow
                    </button>
                    <button id="discard-btn" class="btn btn-secondary">
                        üóë Rejeter
                    </button>
                </div>
            </div>

            <!-- Mode Liste des workflows -->
            <div id="list-mode" class="mode hidden">
                <div class="list-header">
                    <h2>üìö Workflows sauvegard√©s</h2>
                    <button id="back-to-idle" class="btn btn-secondary">‚Üê Retour</button>
                </div>

                <div class="search-section">
                    <input type="search" id="search-workflows" placeholder="Rechercher un workflow...">
                </div>

                <div id="workflows-list" class="workflows-list">
                    <!-- Liste g√©n√©r√©e dynamiquement -->
                </div>

                <div class="list-actions">
                    <button id="export-all" class="btn btn-secondary">üì• Exporter tout</button>
                    <button id="clear-all" class="btn btn-secondary">üóë Tout supprimer</button>
                </div>
            </div>
        </main>
    </div>

    <!-- Modale de s√©lection de format d'export -->
    <div id="export-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üì• Exporter le workflow</h3>
                <button class="modal-close" id="close-export-modal">√ó</button>
            </div>
            <div class="modal-body">
                <p>S√©lectionnez le format d'export :</p>
                <div class="export-formats">
                    <button class="export-format-btn" data-format="json">
                        <span class="format-icon">üìÑ</span>
                        <span class="format-name">JSON</span>
                        <span class="format-desc">Format standard structur√©</span>
                    </button>
                    <button class="export-format-btn" data-format="pdf">
                        <span class="format-icon">üìë</span>
                        <span class="format-name">PDF/HTML</span>
                        <span class="format-desc">Guide visuel</span>
                    </button>
                    <button class="export-format-btn" data-format="selenium">
                        <span class="format-icon">üîß</span>
                        <span class="format-name">Selenium</span>
                        <span class="format-desc">Script de test automatis√©</span>
                    </button>
                    <button class="export-format-btn" data-format="api">
                        <span class="format-icon">üåê</span>
                        <span class="format-name">API</span>
                        <span class="format-desc">Envoyer vers l'API</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modale de vue d√©taill√©e d'un workflow -->
    <div id="view-modal" class="modal hidden">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>üëÅÔ∏è D√©tails du workflow</h3>
                <button class="modal-close" id="close-view-modal">√ó</button>
            </div>
            <div class="modal-body">
                <div id="workflow-details">
                    <!-- Contenu g√©n√©r√© dynamiquement -->
                </div>
            </div>
        </div>
    </div>

    <script src="../background/db-manager.js"></script>
    <script src="../export/json-formatter.js"></script>
    <script src="../export/export-manager.js"></script>
    <script src="popup.js"></script>
</body>
</html>
